(function(){"use strict";var e={586:function(e,t,r){var o=r(471),a=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[e._m(0),t("main",[t("DirectoryForm",{on:{search:e.fetchDirectories,clear:e.clearForm}}),t("div",{staticClass:"table-container"},[t("button",{staticClass:"action-button setting-table-btn",on:{click:e.toggleSettings}},[e._v("Настройки таблицы")]),t("DirectoryTable",{attrs:{directories:e.paginatedDirectories,columns:e.displayColumns},on:{"selected-directories":e.updateSelectedDirectories,"view-directory":e.viewDirectory,"edit-directory":e.editDirectory}})],1),t("DirectoryPagination",{attrs:{totalItems:e.directories.length,itemsPerPage:e.itemsPerPage},on:{"page-changed":e.changePage,"items-per-page-changed":e.updateItemsPerPage}}),t("TableSettings",{attrs:{show:e.showSettings,columns:e.columnLabels,selected:e.selectedColumns},on:{close:e.toggleSettings,apply:e.applySettings}}),t("DirectoryModal",{attrs:{show:e.showModal,directory:e.selectedDirectory},on:{close:e.closeModal}}),t("DirectoryEditModal",{attrs:{show:e.showEditModal,directory:e.selectedDirectory},on:{close:e.closeEditModal,save:e.saveDirectory}})],1)])},s=[function(){var e=this,t=e._self._c;return t("header",{staticClass:"header"},[t("h1",[e._v("Реестр НСИ")])])}],i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"form-container"},[t("h2",[e._v("Реестр справочников")]),t("form",{on:{submit:function(t){return t.preventDefault(),e.search.apply(null,arguments)}}},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"type"}},[e._v("Тип справочника")]),t("select",{directives:[{name:"model",rawName:"v-model",value:e.filters.type,expression:"filters.type"}],attrs:{id:"type"},on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.filters,"type",t.target.multiple?r:r[0])}}},[t("option",{attrs:{value:""}},[e._v("Выберите тип")]),t("option",{attrs:{value:"Пользовательский"}},[e._v("Пользовательский")]),t("option",{attrs:{value:"Технологический"}},[e._v("Технологический")]),t("option",{attrs:{value:"Защищенный"}},[e._v("Защищенный")])])]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"name"}},[e._v("Наименование справочника")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.filters.name,expression:"filters.name"}],attrs:{type:"text",id:"name"},domProps:{value:e.filters.name},on:{input:[function(t){t.target.composing||e.$set(e.filters,"name",t.target.value)},e.autoCompleteName]}}),e.suggestions.name.length?t("ul",{staticClass:"suggestions"},e._l(e.suggestions.name,(function(r){return t("li",{key:r,on:{click:function(t){return e.selectNameSuggestion(r)}}},[e._v(" "+e._s(r)+" ")])})),0):e._e()]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"code"}},[e._v("Код справочника")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.filters.code,expression:"filters.code"}],attrs:{type:"text",id:"code"},domProps:{value:e.filters.code},on:{input:[function(t){t.target.composing||e.$set(e.filters,"code",t.target.value)},e.autoCompleteCode]}}),e.suggestions.code.length?t("ul",{staticClass:"suggestions"},e._l(e.suggestions.code,(function(r){return t("li",{key:r,on:{click:function(t){return e.selectCodeSuggestion(r)}}},[e._v(" "+e._s(r)+" ")])})),0):e._e()]),t("div",{staticClass:"form-actions"},[t("button",{attrs:{type:"submit"}},[e._v("Поиск")]),t("button",{attrs:{type:"button"},on:{click:e.clear}},[e._v("Очистить форму")])])])])},l=[],n=r(605),c={data(){return{filters:{type:"",name:"",code:""},suggestions:{name:[],code:[]}}},methods:{search(){this.$emit("search",this.filters)},clear(){this.filters={type:"",name:"",code:""},this.suggestions={name:[],code:[]},this.$emit("clear")},autoCompleteName(){this.filters.name.length>1?n.A.get("http://localhost:3000/api/directories",{params:{name:this.filters.name}}).then((e=>{this.suggestions.name=e.data.map((e=>e.name))})):this.suggestions.name=[]},autoCompleteCode(){this.filters.code.length>1?n.A.get("http://localhost:3000/api/directories",{params:{code:this.filters.code}}).then((e=>{this.suggestions.code=e.data.map((e=>e.code))})):this.suggestions.code=[]},selectNameSuggestion(e){this.filters.name=e,this.suggestions.name=[]},selectCodeSuggestion(e){this.filters.code=e,this.suggestions.code=[]}}},d=c,u=r(656),m=(0,u.A)(d,i,l,!1,null,null,null),p=m.exports,g=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"selector"},[t("button",{staticClass:"action-button",on:{click:e.toggleActionsMenu}},[e._v("Выбор Действий")]),e.actionsMenuOpen?t("ul",{staticClass:"actions-menu"},[t("li",{class:{disabled:1!==e.selectedDirectories.length},on:{click:e.viewDirectory}},[e._v("Просмотреть справочник")]),t("li",{class:{disabled:1!==e.selectedDirectories.length},on:{click:e.editDirectory}},[e._v("Наполнение справочника")])]):e._e()]),t("table",[t("thead",[t("tr",[t("th",[t("input",{attrs:{type:"checkbox"},on:{change:function(t){return e.toggleAll(t)}}})]),e._l(e.columns,(function(r){return t("th",{key:r},[e._v(e._s(e.columnLabels[r]))])}))],2)]),t("tbody",[e._l(e.directories,(function(r){return t("tr",{key:r._id},[t("td",[t("input",{directives:[{name:"model",rawName:"v-model",value:e.selectedDirectories,expression:"selectedDirectories"}],attrs:{type:"checkbox"},domProps:{value:r._id,checked:Array.isArray(e.selectedDirectories)?e._i(e.selectedDirectories,r._id)>-1:e.selectedDirectories},on:{change:function(t){var o=e.selectedDirectories,a=t.target,s=!!a.checked;if(Array.isArray(o)){var i=r._id,l=e._i(o,i);a.checked?l<0&&(e.selectedDirectories=o.concat([i])):l>-1&&(e.selectedDirectories=o.slice(0,l).concat(o.slice(l+1)))}else e.selectedDirectories=s}}})]),e._l(e.columns,(function(o){return t("td",{key:o},[e._v(e._s(e.formatValue(r[o])))])}))],2)})),0===e.directories.length?t("tr",[t("td",{attrs:{colspan:"5"}},[e._v("Нет доступных данных")])]):e._e()],2)])])},v=[],h={props:{directories:{type:Array,required:!0},columns:{type:Array,required:!0}},data(){return{columnLabels:{code:"Код справочника",type:"Тип справочника",name:"Наименование справочника",startDate:"Дата начала действия",endDate:"Дата окончания действия"},selectedDirectories:[],actionsMenuOpen:!1}},mounted(){document.addEventListener("click",this.handleClickOutside)},beforeDestroy(){document.removeEventListener("click",this.handleClickOutside)},methods:{handleClickOutside(e){this.$el&&!this.$el.contains(e.target)&&(this.actionsMenuOpen=!1)},formatValue(e){return"string"===typeof e&&e.includes("T")?e.split("T")[0]:e},toggleAll(e){e.target.checked?this.selectedDirectories=this.directories.map((e=>e._id)):this.selectedDirectories=[]},toggleActionsMenu(){this.actionsMenuOpen=!this.actionsMenuOpen},viewDirectory(){if(1===this.selectedDirectories.length){const e=this.directories.find((e=>e._id===this.selectedDirectories[0]));this.$emit("view-directory",e),this.actionsMenuOpen=!1}},editDirectory(){if(1===this.selectedDirectories.length){const e=this.directories.find((e=>e._id===this.selectedDirectories[0]));this.$emit("edit-directory",e),this.actionsMenuOpen=!1}}}},f=h,y=(0,u.A)(f,g,v,!1,null,null,null),D=y.exports,_=function(){var e=this,t=e._self._c;return e.show?t("div",{staticClass:"modal"},[t("div",{staticClass:"modal-content"},[t("span",{staticClass:"close",on:{click:e.close}},[e._v("×")]),t("h2",[e._v("Настройки таблицы")]),t("form",e._l(e.columns,(function(r,o){return t("div",{key:o,staticClass:"form-group"},[t("label",[t("input",{directives:[{name:"model",rawName:"v-model",value:e.selectedColumns,expression:"selectedColumns"}],attrs:{type:"checkbox"},domProps:{value:o,checked:Array.isArray(e.selectedColumns)?e._i(e.selectedColumns,o)>-1:e.selectedColumns},on:{change:function(t){var r=e.selectedColumns,a=t.target,s=!!a.checked;if(Array.isArray(r)){var i=o,l=e._i(r,i);a.checked?l<0&&(e.selectedColumns=r.concat([i])):l>-1&&(e.selectedColumns=r.slice(0,l).concat(r.slice(l+1)))}else e.selectedColumns=s}}}),e._v(" "+e._s(r)+" ")])])})),0),t("button",{on:{click:e.applySettings}},[e._v("Применить")])])]):e._e()},P=[],b={props:{show:Boolean,columns:Object,selected:Array},data(){return{selectedColumns:[]}},mounted(){this.selectedColumns=[...this.selected]},methods:{close(){this.$emit("close")},applySettings(){this.$emit("apply",this.selectedColumns),this.close()}}},C=b,w=(0,u.A)(C,_,P,!1,null,null,null),k=w.exports,x=function(){var e=this,t=e._self._c;return t("div",{staticClass:"pagination-container"},[t("div",{staticClass:"pagination-controls"},[t("label",{attrs:{for:"itemsPerPage"}},[e._v("Элементов на странице:")]),t("select",{directives:[{name:"model",rawName:"v-model",value:e.localItemsPerPage,expression:"localItemsPerPage"}],on:{change:[function(t){var r=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.localItemsPerPage=t.target.multiple?r:r[0]},e.updateItemsPerPage]}},e._l(e.perPageOptions,(function(r){return t("option",{key:r,domProps:{value:r}},[e._v(e._s(r))])})),0)]),t("ul",{staticClass:"pagination"},[t("li",{class:{disabled:1===e.currentPage},on:{click:function(t){return e.changePage(e.currentPage-1)}}},[t("a",{attrs:{href:"#"}},[e._v("Предыдущая")])]),e._l(e.totalPages,(function(r){return t("li",{key:r,class:{active:e.currentPage===r},on:{click:function(t){return e.changePage(r)}}},[t("a",{attrs:{href:"#"}},[e._v(e._s(r))])])})),t("li",{class:{disabled:e.currentPage===e.totalPages},on:{click:function(t){return e.changePage(e.currentPage+1)}}},[t("a",{attrs:{href:"#"}},[e._v("Следующая")])])],2)])},S=[],M={props:{totalItems:{type:Number,required:!0},itemsPerPage:{type:Number,required:!0}},data(){return{currentPage:1,localItemsPerPage:this.itemsPerPage,perPageOptions:[4,8,12,16]}},computed:{totalPages(){return Math.ceil(this.totalItems/this.localItemsPerPage)}},methods:{changePage(e){e>0&&e<=this.totalPages&&(this.currentPage=e,this.$emit("page-changed",e))},updateItemsPerPage(){this.$emit("items-per-page-changed",this.localItemsPerPage),this.changePage(1)}}},A=M,O=(0,u.A)(A,x,S,!1,null,null,null),$=O.exports,N=function(){var e=this,t=e._self._c;return e.show?t("div",{staticClass:"modal-overlay"},[t("div",{staticClass:"modal"},[t("h2",[e._v("Паспорт справочника")]),t("form",[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"name"}},[e._v("Наименование")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.localDirectory.name,expression:"localDirectory.name"}],attrs:{type:"text",id:"name",disabled:""},domProps:{value:e.localDirectory.name},on:{input:function(t){t.target.composing||e.$set(e.localDirectory,"name",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"type"}},[e._v("Тип")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.localDirectory.type,expression:"localDirectory.type"}],attrs:{type:"text",id:"type",disabled:""},domProps:{value:e.localDirectory.type},on:{input:function(t){t.target.composing||e.$set(e.localDirectory,"type",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"code"}},[e._v("Код")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.localDirectory.code,expression:"localDirectory.code"}],attrs:{type:"text",id:"code",disabled:""},domProps:{value:e.localDirectory.code},on:{input:function(t){t.target.composing||e.$set(e.localDirectory,"code",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"startDate"}},[e._v("Дата начала действия")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.formattedStartDate,expression:"formattedStartDate"}],attrs:{type:"text",id:"startDate",disabled:""},domProps:{value:e.formattedStartDate},on:{input:function(t){t.target.composing||(e.formattedStartDate=t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"endDate"}},[e._v("Дата окончания действия")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.formattedEndDate,expression:"formattedEndDate"}],attrs:{type:"text",id:"endDate",disabled:""},domProps:{value:e.formattedEndDate},on:{input:function(t){t.target.composing||(e.formattedEndDate=t.target.value)}}})])]),t("button",{on:{click:e.closeModal}},[e._v("Закрыть")])])]):e._e()},E=[],F={props:{show:Boolean,directory:Object},data(){return{localDirectory:{},formattedStartDate:"",formattedEndDate:""}},watch:{directory:{immediate:!0,handler(e){this.localDirectory={...e},this.formattedStartDate=e.startDate?this.formatDate(e.startDate):"",this.formattedEndDate=e.endDate?this.formatDate(e.endDate):""}}},methods:{closeModal(){this.$emit("close")},formatDate(e){const t=new Date(e),r=t.getFullYear(),o=(t.getMonth()+1).toString().padStart(2,"0"),a=t.getDate().toString().padStart(2,"0");return`${r}-${o}-${a}`}}},I=F,T=(0,u.A)(I,N,E,!1,null,null,null),j=T.exports,L=function(){var e=this,t=e._self._c;return e.show?t("div",{staticClass:"modal-overlay"},[t("div",{staticClass:"modal"},[t("h2",[e._v("Редактирование справочника")]),t("form",{on:{submit:function(t){return t.preventDefault(),e.save.apply(null,arguments)}}},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"name"}},[e._v("Наименование")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.localDirectory.name,expression:"localDirectory.name"}],attrs:{type:"text",id:"name"},domProps:{value:e.localDirectory.name},on:{input:function(t){t.target.composing||e.$set(e.localDirectory,"name",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"type"}},[e._v("Тип")]),t("select",{directives:[{name:"model",rawName:"v-model",value:e.localDirectory.type,expression:"localDirectory.type"}],attrs:{id:"type"},on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.localDirectory,"type",t.target.multiple?r:r[0])}}},[t("option",{attrs:{value:"Пользовательский"}},[e._v("Пользовательский")]),t("option",{attrs:{value:"Технологический"}},[e._v("Технологический")]),t("option",{attrs:{value:"Защищенный"}},[e._v("Защищенный")])])]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"code"}},[e._v("Код")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.localDirectory.code,expression:"localDirectory.code"}],attrs:{type:"text",id:"code"},domProps:{value:e.localDirectory.code},on:{input:function(t){t.target.composing||e.$set(e.localDirectory,"code",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"startDate"}},[e._v("Дата начала действия")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.localDirectory.startDateFormatted,expression:"localDirectory.startDateFormatted"}],attrs:{type:"date",id:"startDate"},domProps:{value:e.localDirectory.startDateFormatted},on:{input:function(t){t.target.composing||e.$set(e.localDirectory,"startDateFormatted",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"endDate"}},[e._v("Дата окончания действия")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.localDirectory.endDateFormatted,expression:"localDirectory.endDateFormatted"}],attrs:{type:"date",id:"endDate"},domProps:{value:e.localDirectory.endDateFormatted},on:{input:function(t){t.target.composing||e.$set(e.localDirectory,"endDateFormatted",t.target.value)}}})]),t("button",{attrs:{type:"submit"}},[e._v("Сохранить")]),t("button",{attrs:{type:"button"},on:{click:e.closeModal}},[e._v("Закрыть")])])])]):e._e()},q=[],B={props:{show:Boolean,directory:Object},data(){return{localDirectory:{}}},watch:{directory:{immediate:!0,handler(e){this.localDirectory={...e,startDateFormatted:e.startDate?e.startDate.split("T")[0]:"",endDateFormatted:e.endDate?e.endDate.split("T")[0]:""}}}},methods:{closeModal(){this.$emit("close")},save(){const e={...this.localDirectory,startDate:new Date(this.localDirectory.startDateFormatted).toISOString(),endDate:new Date(this.localDirectory.endDateFormatted).toISOString()};this.$emit("save",e),this.closeModal()}}},V=B,Y=(0,u.A)(V,L,q,!1,null,null,null),z=Y.exports,G={name:"App",components:{DirectoryForm:p,DirectoryTable:D,TableSettings:k,DirectoryPagination:$,DirectoryModal:j,DirectoryEditModal:z},data(){return{directories:[],showSettings:!1,selectedColumns:["code","type","name","startDate","endDate"],columnLabels:{code:"Код справочника",type:"Тип справочника",name:"Наименование справочника",startDate:"Дата начала действия",endDate:"Дата окончания действия"},currentPage:1,itemsPerPage:4,sortAsc:!0,selectedDirectories:[],showModal:!1,showEditModal:!1,selectedDirectory:{}}},computed:{displayColumns(){return this.selectedColumns},paginatedDirectories(){const e=(this.currentPage-1)*this.itemsPerPage,t=e+this.itemsPerPage;return this.directories.slice(e,t)}},methods:{async fetchDirectories(e){try{const t=await n.A.get("http://localhost:3000/api/directories",{params:e});this.directories=t.data,this.changePage(1)}catch(t){console.error("Error fetching directories:",t)}},clearForm(){this.directories=[]},toggleSettings(){this.showSettings=!this.showSettings},applySettings(e){this.selectedColumns=e},changePage(e){this.currentPage=e},updateItemsPerPage(e){this.itemsPerPage=e,this.changePage(1)},updateSelectedDirectories(e){this.selectedDirectories=e},viewDirectory(e){this.selectedDirectory=e,this.showModal=!0},editDirectory(e){this.selectedDirectory=e,this.showEditModal=!0},closeModal(){this.showModal=!1,this.selectedDirectory={}},closeEditModal(){this.showEditModal=!1,this.selectedDirectory={}},async saveDirectory(e){try{await n.A.put(`http://localhost:3000/api/directories/${e._id}`,e),this.fetchDirectories()}catch(t){console.error("Error saving directory:",t)}}}},H=G,J=(0,u.A)(H,a,s,!1,null,null,null),K=J.exports;o.Ay.config.productionTip=!1,new o.Ay({render:e=>e(K)}).$mount("#app")}},t={};function r(o){var a=t[o];if(void 0!==a)return a.exports;var s=t[o]={exports:{}};return e[o](s,s.exports,r),s.exports}r.m=e,function(){var e=[];r.O=function(t,o,a,s){if(!o){var i=1/0;for(d=0;d<e.length;d++){o=e[d][0],a=e[d][1],s=e[d][2];for(var l=!0,n=0;n<o.length;n++)(!1&s||i>=s)&&Object.keys(r.O).every((function(e){return r.O[e](o[n])}))?o.splice(n--,1):(l=!1,s<i&&(i=s));if(l){e.splice(d--,1);var c=a();void 0!==c&&(t=c)}}return t}s=s||0;for(var d=e.length;d>0&&e[d-1][2]>s;d--)e[d]=e[d-1];e[d]=[o,a,s]}}(),function(){r.d=function(e,t){for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};r.O.j=function(t){return 0===e[t]};var t=function(t,o){var a,s,i=o[0],l=o[1],n=o[2],c=0;if(i.some((function(t){return 0!==e[t]}))){for(a in l)r.o(l,a)&&(r.m[a]=l[a]);if(n)var d=n(r)}for(t&&t(o);c<i.length;c++)s=i[c],r.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return r.O(d)},o=self["webpackChunkmy_vue_app"]=self["webpackChunkmy_vue_app"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=r.O(void 0,[504],(function(){return r(586)}));o=r.O(o)})();
//# sourceMappingURL=app.e280eee5.js.map